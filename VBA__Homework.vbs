Sub Chelsea()Dim Ticker As StringDim TotalVolume As DoubleDim Output_Table_Row As IntegerDim Row As IntegerDim YearlyChange As DoubleDim PercentChange As DoubleDim Opening As DoubleDim Closing As DoubleDim ws As WorksheetDim i As IntegerDim j As IntegerDim LastRow As IntegerDim GreatestIncrease_ticker As StringDim GreatestIncrease_value As DoubleDim GreatestDecrease_ticker As StringDim GreatestDecrease_value As DoubleDim GreatestTotalVolme_ticker As StringDim GreatestTotalVolume_value As DoubleFor Each ws In ThisWorkbook.Worksheetsws.ActivateTotalVolume = 0Output_Table_Row = 2i = 2j = 3LastRow = ws.Cells(Rows.Count, 1).End(xlUp).RowFor Row = 2 To LastRowIf Cells(Row + 1, 1).Value <> Cells(Row, 1).Value Then    Ticker = Cells(Row, 1).Value    TotalVolume = TotalVolume + Cells(Row, 7).Value    YearlyChange = Cells(Row, 6).Value - Cells(i, j).Value    PercentChange = (YearlyChange / Cells(i, j).Value) * 100    i = Row + 1    Range("I" & Output_Table_Row).Value = Ticker    Range("L" & Output_Table_Row).Value = TotalVolume    Range("J" & Output_Table_Row).Value = YearlyChange    Range("K" & Output_Table_Row).Value = PercentChange    Output_Table_Row = Output_Table_Row + 1    TotalVolume = 0Else    TotalVolume = TotalVolume + Cells(Row, 7).ValueEnd IfNext RowLastRow = ws.Cells(Rows.Count, 9).End(xlUp).RowGreatestIncrease_value = 0GreatestDecrease_value = 0GreatestTotalVolume_value = 0For Row = 2 To LastRowIf Cells(Row, 10).Value >= 0 ThenCells(Row, 10).Interior.ColorIndex = 4ElseCells(Row, 10).Interior.ColorIndex = 3End IfIf Cells(Row, 11).Value >= 0 ThenCells(Row, 11).Interior.ColorIndex = 4ElseCells(Row, 11).Interior.ColorIndex = 3End IfNext RowOutput_Table_Row = 2For i = 2 To LastRow    If Cells(i, 11) > GreatestIncrease_value Then        GreatestIncrease_value = Cells(i, 11)        Ticker = Cells(i, 9)                Range("O" & Output_Table_Row).Value = Ticker        Range("P" & Output_Table_Row).Value = GreatestIncrease_value            End If    Next iOutput_Table_Row = 3For i = 2 To LastRow    If Cells(i, 11) < GreatestDecrease_value Then        GreatestDecrease_value = Cells(i, 11)        Ticker = Cells(i, 9)                Range("O" & Output_Table_Row).Value = Ticker        Range("P" & Output_Table_Row).Value = GreatestDecrease_value            End If    Next iOutput_Table_Row = 4For i = 2 To LastRow    If Cells(i, 11) > GreatestTotalVolume_value Then        GreatestTotalVolume_value = Cells(i, 12)        Ticker = Cells(i, 9)                Range("O" & Output_Table_Row).Value = Ticker        Range("P" & Output_Table_Row).Value = GreatestTotalVolume_value            End If    Next iNext wsEnd Sub